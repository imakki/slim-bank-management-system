<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <title>Login/Signup Page</title>
  </head>
  <body>
    <div id="signin-register-form">
      <template>
        <div class="vue-tempalte">
          <form @submit.prevent="onSubmit">
            <h3 v-show="register">Register</h3>
            <h3 v-show="!register">Sign In</h3>

            <div class="form-group" v-if="register">
              <label>User Name</label>
              <input
                v-model="username"
                type="text"
                class="form-control form-control-lg"
                required
              />
            </div>

            <div class="form-group">
              <label>Email address</label>
              <input
                v-model="email"
                type="email"
                class="form-control form-control-lg"
                required
              />
            </div>

            <div class="form-group">
              <label>Password</label>
              <input
                v-model="password"
                type="password"
                class="form-control form-control-lg"
                required
              />
            </div>

            <button type="submit" class="btn btn-dark btn-lg btn-block">
              Submit
            </button>
            <button
              v-if="!register"
              type="submit"
              class="btn btn-dark btn-lg btn-block"
              v-on:click.prevent="greet"
            >
              Register
            </button>
          </form>
        </div>
      </template>
    </div>
    <script>
      var app = new Vue({
        el: '#signin-register-form',
        data: {
          register: false,
          username: '',
          email: '',
          password: '',
          userId: null,
        },
        methods: {
          greet: function () {
            this.register = !this.register;
            console.log(this.register);
          },
          onSubmit: function () {
            if (this.register) {
              axios
                .post('http://localhost:3000/api/user/register', {
                  username: this.username,
                  email: this.email,
                  password: this.password,
                })
                .then(function (response) {
                  this.userId = response.data.user_id;
                  console.log(response);
                })
                .catch(function (error) {
                  console.log(error);
                });
              console.log('registering');
            } else {
              axios
                .post('http://localhost:3000/api/user/login', {
                  email: this.email,
                  password: this.password,
                })
                .then(function (response) {
                  this.userId = response.data.user_id;
                  console.log(response);
                })
                .catch(function (error) {
                  console.log(error);
                });
              console.log('sign in');
            }
            (this.username = ''), (this.email = ''), (this.password = '');
          },
        },
      });
    </script>
  </body>
</html>
